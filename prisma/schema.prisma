generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

model RatingUser {
id Int @id @default(autoincrement())
username String 
email String 
password String? 

ratings Rating[]
authProviders AuthProvider[]
}

enum AuthProviderType {
  MICROSOFT
  GOOGLE
}

model AuthProvider {
id Int @id @default(autoincrement())
userId Int
provider AuthProviderType
userProviderId String 

user RatingUser @relation(fields: [userId], references: [id])

@@unique([provider, userProviderId])
}

model Meal {
id Int @id @default(autoincrement())
name String 
imageUrl String 

preparedMeals PreparedMeal[]
}

model PreparedMeal {
id Int @id @default(autoincrement())
mealId Int
averageRating Float
averageTemperature Float

meal Meal @relation(fields: [mealId], references: [id])
ratings Rating[]
}

model Rating {
id Int @id @default(autoincrement())
userId Int
preparedMealId Int
amount_of_meal_rating Int
acceptable_cost_raise Float

user RatingUser @relation(fields: [userId], references: [id])
preparedMeal PreparedMeal @relation(fields: [preparedMealId], references: [id])

@@unique([userId, preparedMealId])
@@check([tempature_rating between 1 and 3])
@@check([amount_of_meal_rating between 1 and 3])
@@check([amount_of_meal_rating >= 0])
}